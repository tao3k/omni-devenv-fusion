{"id":"nix-mkNixago-dmerge-extend","intent":"Extend lefthook.nix config using dmerge to append exclude list and remove commands","syntax_focus":["mkNixago","dmerge","prepend"],"do_not":["Do NOT write (lefthook: lefthook//...) - dmerge is implicit","Do NOT wrap in data={...} unless explicitly required by mkNixago signature"],"allowed_edits":["inherit dmerge prepend","define data field with extend operations","use builtins.removeAttrs for command removal"],"checks":["nix fmt"],"notes":"mkNixago applies dmerge automatically - pass only the fields you want to extend, not full override. Use prepend for lists, builtins.removeAttrs for key removal."}
{"id":"nix-mkNixago-generator-extend","intent":"Extend conform/cog generator config in lefthook.nix using dmerge pattern","syntax_focus":["mkNixago","generator","dmerge","conform","cog"],"do_not":["Do NOT pass data directly without wrapping in data={...}","Do NOT omit initConfigs.conform.default as first argument","Do NOT write full override when extending"],"allowed_edits":["pass default config as first mkNixago arg","define data.policies for conform scopes","use dmerge implicitly via mkNixago"],"checks":["nix fmt"],"notes":"Pattern: mkNixago initConfigs.nixago-conform initConfigs.conform.default { data = { policies = [...]; }; }","example":"gen = (mkNixago initConfigs.nixago-conform) initConfigs.conform.default { data = { policies = [{ type = \"commit\"; spec.conventional.scopes = [\"nix\" \"mcp\"]; }]; }; }"}
{"id":"nix-module-args-keep-ellipsis","intent":"Add optional module argument while preserving backwards compatibility","syntax_focus":["module-args-attrset","ellipsis"],"do_not":["Do NOT remove `...` from module args","Do NOT replace `{ config, lib, pkgs, ... }:` with `args:`"],"allowed_edits":["add_optional_arg_with_default","update_let_bindings","update_inherit"],"checks":["nix fmt","statix check","deadnix","nix flake check"],"before":"{ config, lib, pkgs, ... }:","after":"{ config, lib, pkgs, myOpt ? null, ... }:"}
{"id":"nix-dmerge-import-flake-inputs","intent":"Fix dmerge import path when accessed through nested flake inputs","syntax_focus":["dmerge","inherit","inputs"],"do_not":["Do NOT use dmerge directly without proper import path","Do NOT access nested flake inputs incorrectly"],"allowed_edits":["update import path in inherit statement","access dmerge through correct flake input chain"],"checks":["nix fmt","nix flake check"],"example":"inherit (inputs.omnibus.inputs.flops.inputs.dmerge) prepend;"}
{"id":"nix-lefthook-commands-access","intent":"Fix lefthook commands access path for pre-commit configuration","syntax_focus":["lefthook","commands","data"],"do_not":["Do NOT use lefthook.data.pre-commit.commands","Do NOT access commands without .default prefix when using mkNixago"],"allowed_edits":["add .default before .data","update command access path"],"checks":["nix fmt","nix flake check"],"example":"commands = builtins.removeAttrs lefthook.default.data.pre-commit.commands [ \"treefmt\" ];"}
{"id":"nix-omnibus-devenv-inputs-filtering","intent":"Pass inputs through devenv filter using __inputs__ and __nixpkgs__ in omnibus loader","syntax_focus":["omnibus","__inputs__","__nixpkgs__","devenv"],"do_not":["Do NOT pass inputs/nixpkgs directly in load - they are filtered by devenv","Do NOT omit __inputs__ when you need to access inputs in nested modules"],"allowed_edits":["add __inputs__ section filtered inputs","add to pass __nixpkgs__ section for nixpkgs passthrough","use inputs = { inherit nixpkgs; } for available inputs in module args"],"checks":["nix fmt","nix flake check"],"example":"load = {\n  src = ./units/modules;\n  inputs = {\n    inherit nixpkgs-latest;\n    __inputs__ = { inherit nixpkgs-latest packages; };\n    inputs = { nixpkgs = nixpkgs-latest; };\n  };\n};"}
