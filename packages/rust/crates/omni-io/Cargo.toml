[package]
name = "omni-io"
version.workspace = true
edition.workspace = true

[dependencies]
thiserror = { workspace = true }
memchr = { workspace = true }
tokio = { workspace = true, features = ["fs", "io-util"] }
# Context Assembly dependencies
rayon = "1.8"
minijinja = "1.0"
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
omni-tokenizer = { path = "../omni-tokenizer" }
# Event Bus for reactive file watching (optional)
omni-events = { path = "../omni-events", optional = true }
# File watching crate (optional, requires notify feature)
# Enable all features for cross-platform support (macOS fsevent, Windows, inotify)
notify = { version = "6.0", features = ["serde"], optional = true }
# Pattern matching using ripgrep's GlobSet (high-performance)
globset = { version = "0.4", optional = true }

[features]
default = []
assembler = []  # Enable context assembly functionality
notify = ["omni-events", "dep:notify", "dep:globset"]  # Enable file watching with event publishing

[dev-dependencies]
tempfile = "3.12"
